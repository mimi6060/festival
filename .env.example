# =============================================================================
# FESTIVAL MANAGEMENT PLATFORM - ENVIRONMENT VARIABLES
# =============================================================================
# This file documents all environment variables used by the platform.
# Copy this file and rename it according to your environment:
#   - .env.development (local development)
#   - .env.test (testing)
#   - .env.production (production - use secrets manager)
#
# SECURITY WARNING: NEVER commit .env files with real secrets to version control!
# =============================================================================

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================
# Environment: development | test | staging | production
NODE_ENV=development

# Application metadata
APP_NAME="Festival Platform"
APP_VERSION=1.0.0
APP_DESCRIPTION="Multi-tenant festival management platform"

# URLs
APP_URL=http://localhost:3000
API_URL=http://localhost:3333
ADMIN_URL=http://localhost:4200

# Server configuration
PORT=3333
API_PREFIX=api
API_VERSION=v1

# Enable/disable debug mode
DEBUG=false

# =============================================================================
# DATABASE - PostgreSQL
# =============================================================================
# Connection settings
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_NAME=festival_db
DATABASE_USER=festival_user
DATABASE_PASSWORD=your_secure_password_here

# Full connection URL (Prisma format)
# Format: postgresql://USER:PASSWORD@HOST:PORT/DATABASE?schema=public
# Note: connection_limit and pool_timeout can be added to URL or set separately below
DATABASE_URL=postgresql://${DATABASE_USER}:${DATABASE_PASSWORD}@${DATABASE_HOST}:${DATABASE_PORT}/${DATABASE_NAME}?schema=public

# Prisma Connection Pooling
# These parameters are automatically appended to DATABASE_URL by PrismaService
# connection_limit: Maximum number of connections in the pool (default: 10)
# pool_timeout: Maximum time to wait for a connection in seconds (default: 10)
# See: https://www.prisma.io/docs/concepts/components/prisma-client/connection-management
DATABASE_CONNECTION_LIMIT=10
DATABASE_POOL_TIMEOUT=10

# Alternative: Set pool params directly in DATABASE_URL
# DATABASE_URL=postgresql://user:pass@host:5432/db?schema=public&connection_limit=10&pool_timeout=10

# Legacy connection pooling settings (for external poolers like PgBouncer)
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10
DATABASE_CONNECTION_TIMEOUT=30000

# SSL configuration (enable in production)
DATABASE_SSL_ENABLED=false
DATABASE_SSL_REJECT_UNAUTHORIZED=true

# =============================================================================
# REDIS - Cache & Session Store
# =============================================================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_TLS_ENABLED=false

# Full connection URL
# Format: redis://[:PASSWORD@]HOST:PORT/DB
REDIS_URL=redis://${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB}

# Redis cluster mode (for production)
REDIS_CLUSTER_ENABLED=false
REDIS_CLUSTER_NODES=

# Cache settings
CACHE_TTL=3600
CACHE_MAX_ITEMS=10000

# =============================================================================
# AUTHENTICATION - JWT
# =============================================================================
# IMPORTANT: Use strong, unique secrets in production (min 32 characters)
# Generate with: openssl rand -base64 64

# Access token (short-lived)
JWT_SECRET=your_super_secret_jwt_key_min_32_chars_here_change_in_prod
JWT_EXPIRES_IN=15m

# Refresh token (long-lived)
JWT_REFRESH_SECRET=your_super_secret_refresh_key_min_32_chars_here_change_in_prod
JWT_REFRESH_EXPIRES_IN=7d

# Token settings
JWT_ISSUER=festival-api
JWT_AUDIENCE=festival-app
JWT_ALGORITHM=HS256

# Password hashing
BCRYPT_SALT_ROUNDS=12

# Session settings
SESSION_SECRET=your_session_secret_here
SESSION_MAX_AGE=86400000

# =============================================================================
# AUTHENTICATION - OAuth 2.0 (Optional)
# =============================================================================
# Google OAuth
GOOGLE_OAUTH_ENABLED=false
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_CALLBACK_URL=${API_URL}/auth/google/callback

# Facebook OAuth
FACEBOOK_OAUTH_ENABLED=false
FACEBOOK_APP_ID=
FACEBOOK_APP_SECRET=
FACEBOOK_CALLBACK_URL=${API_URL}/auth/facebook/callback

# Apple Sign In
APPLE_OAUTH_ENABLED=false
APPLE_CLIENT_ID=
APPLE_TEAM_ID=
APPLE_KEY_ID=
APPLE_PRIVATE_KEY=
APPLE_CALLBACK_URL=${API_URL}/auth/apple/callback

# =============================================================================
# PAYMENT - STRIPE
# =============================================================================
# Get keys from: https://dashboard.stripe.com/apikeys
# Use test keys (sk_test_*, pk_test_*) for development

STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key
STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_publishable_key

# Webhook secret for verifying Stripe events
# Get from: https://dashboard.stripe.com/webhooks
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret

# Default currency (ISO 4217)
STRIPE_CURRENCY=eur

# Stripe Connect (for marketplace payouts to vendors)
STRIPE_CONNECT_ENABLED=false
STRIPE_CONNECT_CLIENT_ID=

# Payment settings
PAYMENT_MIN_AMOUNT=100
PAYMENT_MAX_AMOUNT=100000000

# =============================================================================
# EMAIL - SMTP
# =============================================================================
# SMTP server settings
SMTP_HOST=localhost
SMTP_PORT=1025
SMTP_SECURE=false
SMTP_USER=
SMTP_PASSWORD=

# Sender information
SMTP_FROM_NAME="Festival Platform"
SMTP_FROM_EMAIL=noreply@festival-platform.com
SMTP_REPLY_TO=support@festival-platform.com

# Email templates path
EMAIL_TEMPLATES_PATH=./templates/email

# Email queue settings
EMAIL_QUEUE_ENABLED=false
EMAIL_MAX_RETRIES=3

# =============================================================================
# FILE STORAGE - S3/MinIO
# =============================================================================
# Storage type: local | s3 | minio
STORAGE_TYPE=local

# Local storage (development)
UPLOAD_LOCAL_PATH=./uploads
UPLOAD_BASE_URL=/uploads

# AWS S3 / MinIO settings
AWS_REGION=eu-west-3
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_S3_BUCKET=festival-uploads
AWS_S3_ENDPOINT=
AWS_S3_PUBLIC_URL=

# Upload limits (in bytes)
UPLOAD_MAX_SIZE=10485760
UPLOAD_MAX_IMAGE_SIZE=5242880
UPLOAD_ALLOWED_MIME_TYPES=image/jpeg,image/png,image/gif,image/webp,application/pdf

# Signed URL expiry (seconds)
AWS_SIGNED_URL_EXPIRY=3600

# =============================================================================
# PUSH NOTIFICATIONS
# =============================================================================
# Firebase Cloud Messaging (Android & Web)
FIREBASE_ENABLED=false
FIREBASE_PROJECT_ID=
FIREBASE_PRIVATE_KEY=
FIREBASE_CLIENT_EMAIL=
FIREBASE_DATABASE_URL=

# Full Firebase config (JSON string)
FIREBASE_CONFIG=

# Apple Push Notifications (iOS)
APNS_ENABLED=false
APNS_KEY_ID=
APNS_TEAM_ID=
APNS_BUNDLE_ID=
APNS_PRODUCTION=false

# =============================================================================
# EXTERNAL SERVICES
# =============================================================================
# Sentry - Error tracking
# Get DSN from: https://sentry.io/settings/projects/{project}/keys/
SENTRY_ENABLED=false
SENTRY_DSN=
SENTRY_ENVIRONMENT=${NODE_ENV}
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.1

# Google Maps API
GOOGLE_MAPS_API_KEY=

# Twilio (SMS notifications)
TWILIO_ENABLED=false
TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=
TWILIO_PHONE_NUMBER=

# =============================================================================
# SECURITY
# =============================================================================
# CORS - Comma-separated list of allowed origins
CORS_ORIGINS=http://localhost:3000,http://localhost:4200,http://localhost:19006

# Rate limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false

# Throttling for specific endpoints
THROTTLE_TTL=60
THROTTLE_LIMIT=10

# CSRF protection
CSRF_ENABLED=true
CSRF_SECRET=your_csrf_secret_here

# QR Code signing secret (HMAC-SHA256)
QR_SECRET=your_qr_code_signing_secret_here_min_32_chars

# Encryption key for sensitive data (AES-256)
ENCRYPTION_KEY=your_32_byte_encryption_key_here

# =============================================================================
# LOGGING & MONITORING
# =============================================================================
# Log level: error | warn | info | http | verbose | debug | silly
LOG_LEVEL=debug

# Log format: json | pretty
LOG_FORMAT=pretty

# Log output directory
LOG_DIR=./logs

# Log retention (days)
LOG_RETENTION_DAYS=30

# Request logging
LOG_REQUESTS=true
LOG_RESPONSES=false
LOG_BODY=false

# Prometheus metrics
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090
PROMETHEUS_PATH=/metrics

# Sentry error tracking
# Get your DSN from https://sentry.io/settings/projects/{project}/keys/
SENTRY_DSN=https://your_public_key@o123456.ingest.sentry.io/1234567
SENTRY_ENVIRONMENT=${NODE_ENV}
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.1

# =============================================================================
# FEATURE FLAGS
# =============================================================================
FEATURE_REGISTRATION_ENABLED=true
FEATURE_PAYMENT_ENABLED=true
FEATURE_CASHLESS_ENABLED=true
FEATURE_PUSH_NOTIFICATIONS_ENABLED=false
FEATURE_SMS_NOTIFICATIONS_ENABLED=false
FEATURE_OAUTH_ENABLED=false
FEATURE_API_DOCS_ENABLED=true
FEATURE_GRAPHQL_ENABLED=false

# =============================================================================
# QUEUE & WORKERS (Bull/BullMQ)
# =============================================================================
QUEUE_ENABLED=true
QUEUE_DEFAULT_JOB_OPTIONS_ATTEMPTS=3
QUEUE_DEFAULT_JOB_OPTIONS_BACKOFF=5000
QUEUE_DEFAULT_JOB_OPTIONS_REMOVE_ON_COMPLETE=true
QUEUE_DEFAULT_JOB_OPTIONS_REMOVE_ON_FAIL=false

# =============================================================================
# ADMIN & SUPERUSER
# =============================================================================
# Initial admin account (created on first run)
ADMIN_EMAIL=admin@festival-platform.com
ADMIN_PASSWORD=admin_secure_password_change_me
ADMIN_FIRST_NAME=Admin
ADMIN_LAST_NAME=System

# =============================================================================
# MOBILE APP SETTINGS
# =============================================================================
# Deep linking
MOBILE_DEEP_LINK_SCHEME=festivalapp
MOBILE_DEEP_LINK_HOST=app.festival-platform.com

# Offline sync
MOBILE_SYNC_INTERVAL=300000
MOBILE_OFFLINE_CACHE_TTL=86400000

# =============================================================================
# DOCUMENTATION
# =============================================================================
SWAGGER_ENABLED=true
SWAGGER_TITLE="Festival Platform API"
SWAGGER_DESCRIPTION="API documentation for the Festival Management Platform"
SWAGGER_VERSION=1.0.0
SWAGGER_PATH=api/docs

# =============================================================================
# TESTING
# =============================================================================
# Test database (used by jest)
TEST_DATABASE_URL=postgresql://festival_user:festival_password@localhost:5432/festival_test

# Test Redis
TEST_REDIS_URL=redis://localhost:6379/1

# E2E test settings
E2E_BASE_URL=http://localhost:3333
E2E_TIMEOUT=30000
